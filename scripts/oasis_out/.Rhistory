ge_mn
dge_mn
write.csv(dge_mn,
file = paste0(output_dir,'/signifcant_genes/mutExpo_mutUnexpo_dge.csv'))
## Clear the environmental space here to start affresh
## Clear environmental space
rm(list = ls())
set.seed(101)
## Set the directory with the expression datasets here
setwd('/Users/gwk/Desktop/Bioinformatics/bulk-rnaseq-zebrafish-mouse-human/data')
## Load the datasets to be analysed here
countMatrix <- read.csv('raw_count_matrix.csv', row.names = 1)
head(countMatrix)
## Load the datasets to be analysed here
countMatrix <- read.csv('raw_count_matrix.csv', row.names = 1)
samples <- read.csv("./samplieinformation.csv", row.names = 1)
## Clear the environmental space here to start affresh
## Clear environmental space
rm(list = ls())
## Set the directory with the expression datasets here
setwd('/Users/gwk/Desktop/Bioinformatics/bulk-rnaseq-zebrafish-mouse-human/data')
# This is the output folder for the final analysis
output_dir = '/Users/gwk/Desktop/Thesis Figures/DifferentialGeneExpression/'
output_dir = '/Users/gwk/Desktop/Thesis Figures/'
## Source user defined files containing some useful functions here
source("/Users/gwk/Desktop/Bioinformatics/bulk-rnaseq-zebrafish-mouse-human/scripts/functionsneededforanalysis.R")
## Load the datasets to be analysed here
countMatrix <- read.csv('raw_count_matrix.csv', row.names = 1)
samples <- read.csv("./samplieinformation.csv", row.names = 1)
## Split the datasets into WT and Home
wt_sample_info <- samples |>
filter(Genotype == 'wt')
wtcountmtx <- countMatrix |>
select(row.names(wt_sample_info))
mut_sample_info <- samples |>
filter(Genotype == 'mutant')
mutcountmtx <- countMatrix |>
select(row.names(mut_sample_info))
## Filter before creating the DESeq object
##Although filtering with DESeq is not reccomended, here we remove all genes whose
## row sum is less than 10
keep <- rowSums(countMatrix > 10) >= 6
countMatrix <- countMatrix[keep,]
keep_wt <- rowSums(wtcountmtx > 10) >= 3
wtcountmtx <- wtcountmtx[keep_wt,]
keep_mut <- rowSums(mutcountmtx > 10) >= 3
mutcountmtx <- mutcountmtx[keep_mut,]
# Build a DESeq2 object here. The count data is given as a metrix, column names
# are the samples and the rownames are the Ensemble gene ids. This is important
# The design contains what makes up the model (negatve bionimial model in this case)
dds <- DESeqDataSetFromMatrix(countData = as.matrix(countMatrix),
colData = samples,
design = ~ Group)
## Wild type only datasets, see PCA sample clustering for more insight into this choice
ddswt <- DESeqDataSetFromMatrix(countData = as.matrix(wtcountmtx),
colData = wt_sample_info,
design = ~ Group)
## Mutant only datasets, see PCA sample clustering for more insight into this choice
ddsmut <- DESeqDataSetFromMatrix(countData = as.matrix(mutcountmtx),
colData = mut_sample_info,
design = ~ Group)
## Relevel the conditions here
dds$Group <- relevel(dds$Group, ref = 'wt_unexposed')
#dds$Group <- relevel(dds$Group, ref = 'mut_unexposed')
# Relevel the Wild type data here so the unexposed is the reference group
ddswt$Group <- relevel(ddswt$Group, ref = 'wt_unexposed')
ddsmut$Group <- relevel(ddsmut$Group, ref = 'mut_unexposed')
set.seed(101)
dds <- DESeq(dds)
ddsmut <- DESeq(ddsmut)
ddswt <- DESeq(ddswt)
results(ddsmut)
## Extract Group comparisons here
## ========================= Mutant,Exposed vs Mutant unexposed ===============
resMut <- results(ddsmut)
summary(resMut)
resultsNames(ddsmut)
mutantExposed <- results(ddsmut, name = "Group_mut_exposed_vs_mut_unexposed")
mutantExposed <- lfcShrink(ddsmut, coef = 2, type = 'apeglm')
nrow(mutantExposed)
nrow(mutantExposed$padj < 0.05)
nrow(mutantExposed[mutantExposed$padj < 0.05,])
mutantExposed |>
as.data.frame() |>
filter(padj < 0.05)
mutantExposed |>
as.data.frame() |>
filter(padj < 0.05) |>
nrow()
# Remove all genes that are not annotated here
mutantExposed <- mutantExposed[!grepl('LOC', rownames(mutantExposed)), ]
mutantExposed |>
as.data.frame() |>
filter(padj < 0.05) |>
nrow()
## Clear the global environment space
rm(list = ls())
set.seed(101)
## Load the file with all the required libraries here
source("/Users/gwk/Desktop/Bioinformatics/bulk-rnaseq-zebrafish-mouse-human/scripts/functionsneededforanalysis.R")
source("/Users/gwk/Desktop/Bioinformatics/bulk-rnaseq-zebrafish-mouse-human/scripts/visualisationFunctions.R")
### Set the working directory here. This is the path to the GO term/pathway files
output_dir = '/Users/gwk/Desktop/Thesis Figures/DifferentialGeneExpression'#/MutantUnexposed/Figures'
setwd('/Users/gwk/Desktop/Thesis Figures')
## Load the datasets to be analysed here (these are dge files)
mutExposed <-read.csv('mutant_mutant/mnExposuredge.csv', row.names = 1)
mutUnexpo <- read.csv('mutantEffects/mutunexposedwtUnexposed.csv', row.names = 1)
wtExposed <- read.csv('mnExposureEffect/mnExposuredge.csv', row.names = 1)
wtExposed |>
as.data.frame() |>
filter(padj < 0.05) |>
select(c(7,2,5,6)) |>
mutate('log2FoldChange'=round(log2FoldChange,2),'padj' = round(padj,2)) |>
arrange(desc(log2FoldChange))
mutExposed |>
as.data.frame() |>
filter(padj < 0.05) |>
select(c(7,2,5,6)) |>
mutate('log2FoldChange'=round(log2FoldChange,2),'padj' = round(padj,2)) |>
arrange(desc(log2FoldChange))
mutExposed |>
as.data.frame() |>
filter(padj < 0.05) |>
select(c(7,2,5,6)) |>
mutate('log2FoldChange'=round(log2FoldChange,2),'padj' = round(padj,2)) |>
arrange(desc(padj))
mutExposed |>
as.data.frame() |>
filter(padj < 0.05) |>
select(c(7,2,5,6)) |>
mutate('log2FoldChange'=round(log2FoldChange,2),'padj' = round(padj,2)) |>
arrange(desc(log2FoldChange))
mutExposed <- mutExposed[!grepl('si:', rownames(mutExposed)), ]
mutExposed <- mutExposed[!grepl('zgc:', rownames(mutExposed)), ]
mutExposed |>
as.data.frame() |>
filter(padj < 0.05) |>
select(c(7,2,5,6)) |>
mutate('log2FoldChange'=round(log2FoldChange,2),'padj' = round(padj,2)) |>
arrange(desc(log2FoldChange))
mutExposed |>
as.data.frame() |>
filter(padj < 0.05) |>
select(c(7,2,5,6)) |>
mutate('log2FoldChange'=round(log2FoldChange,2),'padj' = round(padj,2)) |>
arrange(desc(log2FoldChange)) |>
gt(auto_align = T)
## Load the datasets to be analysed here (these are dge files)
mutExposed <-read.csv('mutant_mutant/mnExposuredge.csv', row.names = 1)
## Filter out the un-annotated genes
mutExposed <- mutExposed[!grepl('si:', rownames(mutExposed)), ]
mutExposed <- mutExposed[!grepl('zgc:', rownames(mutExposed)), ]
mutUnexpo <- read.csv('mutantEffects/mutunexposedwtUnexposed.csv', row.names = 1)
## Filter out the un-annotated genes
mutUnexpo <- mutUnexpo[!grepl('si:', rownames(mutUnexpo)), ]
mutUnexpo <- mutUnexpo[!grepl('zgc:', rownames(mutUnexpo)), ]
wtExposed <- read.csv('mnExposureEffect/mnExposuredge.csv', row.names = 1)
## Filter out the un-annotated genes
wtExposed <- wtExposed[!grepl('si:', rownames(wtExposed)), ]
wtExposed <- wtExposed[!grepl('zgc:', rownames(wtExposed)), ]
mutExposed |>
as.data.frame() |>
filter(padj < 0.05) |>
select(c(7,2,5,6)) |>
mutate('log2FoldChange'=round(log2FoldChange,2),'padj' = round(padj,2)) |>
arrange(desc(log2FoldChange)) |>
nrow(10)
mutExposed |>
as.data.frame() |>
filter(padj < 0.05) |>
select(c(7,2,5,6)) |>
mutate('log2FoldChange'=round(log2FoldChange,2),'padj' = round(padj,2)) |>
arrange(desc(log2FoldChange)) |>
nrow()
mutExposed |>
as.data.frame()
mutExposed |>
as.data.frame() |>
filter(padj < 0.05) |>
select(c(7,2,5,6)) |>
mutate('log2FoldChange'=round(log2FoldChange,2),'padj' = round(padj,2)) |>
arrange(desc(log2FoldChange)) |>
iloc[1:10]
mutExposed |>
as.data.frame() |>
filter(padj < 0.05) |>
select(c(7,2,5,6)) |>
mutate('log2FoldChange'=round(log2FoldChange,2),'padj' = round(padj,2)) |>
arrange(desc(log2FoldChange)) |>
filter(1:10)
mutExposed |>
as.data.frame() |>
filter(padj < 0.05) |>
select(c(7,2,5,6)) |>
mutate('log2FoldChange'=round(log2FoldChange,2),'padj' = round(padj,2)) |>
arrange(desc(log2FoldChange)) |>
head(10)
mutExposed |>
as.data.frame() |>
filter(padj < 0.05) |>
select(c(7,2,5,6)) |>
mutate('log2FoldChange'=round(log2FoldChange,2),'padj' = round(padj,2)) |>
arrange(desc(log2FoldChange)) |>
head(10) |>
gt(auto_align = T) |>
?
)
mutExposed |>
as.data.frame() |>
filter(padj < 0.05) |>
select(c(7,2,5,6)) |>
mutate('log2FoldChange'=round(log2FoldChange,2),'padj' = round(padj,2)) |>
arrange(desc(log2FoldChange)) |>
head(10) |>
gt(auto_align = T)
mutExposed |>
as.data.frame() |>
filter(padj < 0.05) |>
select(c(7,2,5,6)) |>
mutate('log2FoldChange'=round(log2FoldChange,2),'padj' = round(padj,2)) |>
arrange(desc(log2FoldChange)) |>
head(10) |>
gt(auto_align = T) |>
gt::gtsave(filename = "./Tables/Top10DGE_genes.rtf")
mutExposed |>
as.data.frame() |>
filter(padj < 0.05) |>
select(c(7,2,5,6)) |>
mutate('log2FoldChange'=round(log2FoldChange,2),'padj' = round(padj,2)) |>
arrange(desc(log2FoldChange)) |>
head(10) |>
gt(auto_align = T) |>
gt::gtsave(filename = "./Tables/Top10DGE_genesMutExp.rtf")
wtExposed |>
as.data.frame() |>
filter(padj < 0.05) |>
select(c(7,2,5,6)) |>
mutate('log2FoldChange'=round(log2FoldChange,2),'padj' = round(padj,2)) |>
arrange(desc(log2FoldChange)) |>
head(10) |>
gt(auto_align = T) |>
gt::gtsave(filename = "./Tables/Top10DGE_genesWtExp.rtf")
mutUnexpo |>
as.data.frame() |>
filter(padj < 0.05) |>
select(c(7,2,5,6)) |>
mutate('log2FoldChange'=round(log2FoldChange,2),'padj' = round(padj,2)) |>
arrange(desc(log2FoldChange)) |>
head(10) |>
gt(auto_align = T) |>
gt::gtsave(filename = "./Tables/Top10DGE_genesmutUnexpxp.rtf")
# ## Selected gene lists to explore
erProteostasis <- c('canx','calr3a','p4hb','pdia4','txndc5','fkbp9','hsp90b1',
'hspa5','hsp90aa1.1','cct2')
t1 <- mutExposed[erProteostasis,] |>
select(c(7,2,5)) |>
mutate('log2FoldChange' = round(log2FoldChange, 2),
padj = round(padj, 3)) |>
rename('log2FoldChange'='mutExposed')
t2 <- wtExposed[erProteostasis,] |>
select(c(7,2,5)) |>
mutate('log2FoldChange' = round(log2FoldChange, 2),
padj = round(padj, 3)) |>
rename('log2FoldChange' = 'wtExposed')
t3 <- mutUnexpo[erProteostasis,] |>
select(c(7,2,5)) |>
mutate('log2FoldChange' = round(log2FoldChange, 2),
padj = round(padj, 3)) |>
rename('log2FoldChange' = 'MutantionOnly')
wtExposed |>
as.data.frame() |>
filter(padj < 0.05) |>
select(c(7,2,5,6)) |>
mutate('log2FoldChange'=round(log2FoldChange,2),'padj' = round(padj,2)) |>
arrange(desc(log2FoldChange)) |>
head(10) |>
gt(auto_align = T)
wtExposed |>
as.data.frame() |>
filter(padj < 0.05) |>
select(c(7,2,5,6)) |>
mutate('log2FoldChange'=round(log2FoldChange,2),'padj' = round(padj,2)) |>
arrange(desc(log2FoldChange)) |>
head(10)
wtExposed <- read.csv('mnExposureEffect/mnExposuredge.csv', row.names = 1)
## Load the file with all the required libraries here
source("/Users/gwk/Desktop/Bioinformatics/bulk-rnaseq-zebrafish-mouse-human/scripts/functionsneededforanalysis.R")
source("/Users/gwk/Desktop/Bioinformatics/bulk-rnaseq-zebrafish-mouse-human/scripts/visualisationFunctions.R")
set.seed(101)
wtExposed_gsea <- simplify(rungseondata(geneList = creategenelist(wtExposed)),
cutoff = 0.5, by = 'p.adjust', measure = 'Wang')
wtExposed_gsea |>
as.data.frame()
wtExposed_kegg <- gseKEGG(geneList     = creategenelist(na.omit(wtExposed[,c(7,8,2)]), 'other'),
organism     = 'dre',
nPerm        = 10000,
minGSSize    = 3,
maxGSSize    = 800,
pvalueCutoff = 0.05,
pAdjustMethod = "none",
keyType       = "ncbi-geneid")
wtExposed_kegg |>
as.data.frame()
wtExposed <- read.csv('mnExposureEffect/mnExposuredge.csv', row.names = 1)
wtExposed_kegg <- gseKEGG(geneList     = creategenelist(na.omit(wtExposed[,c(7,8,2)]), 'other'),
organism     = 'dre',
nPerm        = 10000,
minGSSize    = 3,
maxGSSize    = 800,
pvalueCutoff = 0.05,
pAdjustMethod = "none",
keyType       = "ncbi-geneid")
wtExposed_kegg |>
as.data.frame()
wtExposed_kegg |>
as.data.frame() |>
nrow()
getwd()
### Set the working directory here. This is the path to the GO term/pathway files
output_dir = '/Users/gwk/Desktop/Thesis Figures/DifferentialGeneExpression'#/MutantUnexposed/Figures'
dir()
wtExposed <- read.csv('mnExposureEffect/mnExposuredge.csv', row.names = 1)
wtExposed_gsea <- simplify(rungseondata(geneList = creategenelist(wtExposed)),
cutoff = 0.5, by = 'p.adjust', measure = 'Wang')
wtExposed_gsea |>
as.data.frame() |>
nrow()
wtExposed_gsea |>
as.data.frame()
write.csv(wtExposed_gsea,
file = paste0(output_dir,'/WildtypeExposed/gseaanalysis.csv'))
dir()
write.csv(wtExposed_kegg,
file = paste0(output_dir,'/WildtypeExposed/kegg_pathway_analysis.csv'))
wtExposed <- read.csv('mnExposureEffect/mnExposuredge.csv', row.names = 1)
## Filter out the un-annotated genes
wtExposed <- wtExposed[!grepl('si:', rownames(wtExposed)), ]
wtExposed <- wtExposed[!grepl('zgc:', rownames(wtExposed)), ]
wtExposed |>
as.data.frame() |>
filter(padj < 0.05) |>
select(c(7,2,5,6)) |>
mutate('log2FoldChange'=round(log2FoldChange,2),'padj' = round(padj,2)) |>
arrange(desc(log2FoldChange)) |>
head(10)
wtExposed |>
as.data.frame() |>
filter(padj < 0.05) |>
select(c(7,2,5,6)) |>
mutate('log2FoldChange'=round(log2FoldChange,2),'padj' = round(padj,2)) |>
arrange(desc(log2FoldChange)) |>
head(10) |>
gt(auto_align = T) |>
gt::gtsave(filename = "./Tables/Top10DGE_geneswtExpxp.rtf")
mutUnexpo <- read.csv('mutantEffects/mutunexposedwtUnexposed.csv', row.names = 1)
## Filter out the un-annotated genes
mutUnexpo <- mutUnexpo[!grepl('si:', rownames(mutUnexpo)), ]
mutUnexpo <- mutUnexpo[!grepl('zgc:', rownames(mutUnexpo)), ]
wtExposed |>
as.data.frame() |>
filter(padj < 0.05) |>
select(c(7,2,5,6)) |>
mutate('log2FoldChange'=abs(round(log2FoldChange,2)),'padj' = round(padj,2))
wtExposed |>
as.data.frame() |>
filter(padj < 0.05) |>
select(c(7,2,5,6)) |>
mutate('log2FoldChange'=abs(round(log2FoldChange,2)),'padj' = round(padj,2)) |>
arrange(desc(log2FoldChange))
mutExposed |>
as.data.frame() |>
filter(padj < 0.05) |>
select(c(7,2,5,6)) |>
mutate('log2FoldChange'=abs(round(log2FoldChange,2)),'padj' = round(padj,2)) |>
arrange(desc(log2FoldChange)) |>
head(10)
mutExposed |>
as.data.frame() |>
filter(padj < 0.05) |>
select(c(7,2,5,6)) |>
mutate('log2FoldChange'=round(log2FoldChange,2),'padj' = round(padj,2)) |>
arrange(desc(log2FoldChange)) |>
head(10) |>
gt(auto_align = T) |>
gt::gtsave(filename = "./Tables/Top10DGE_UPgenesmutExpxp.rtf")
mutExposed |>
as.data.frame() |>
filter(padj < 0.05 & log2FoldChange < 0) |>
select(c(7,2,5,6)) |>
mutate('log2FoldChange'=round(log2FoldChange,2),'padj' = round(padj,2)) |>
arrange(desc(log2FoldChange)) |>
head(10)
mutExposed |>
as.data.frame() |>
filter(padj < 0.05 & log2FoldChange < 0) |>
select(c(7,2,5,6)) |>
mutate('log2FoldChange'=round(log2FoldChange,2),'padj' = round(padj,2)) |>
arrange(log2FoldChange) |>
head(10)
mutExposed |>
as.data.frame() |>
filter(padj < 0.05 & log2FoldChange < 0) |>
select(c(7,2,5,6)) |>
mutate('log2FoldChange'=round(log2FoldChange,2),'padj' = round(padj,2)) |>
arrange(log2FoldChange) |>
head(10) |>
gt(auto_align = T) |>
gt::gtsave(filename = "./Tables/Top10DGE_DOWNgenesmutExpxp.rtf")
wtExposed |>
as.data.frame() |>
filter(padj < 0.05 & log2FoldChange < 0) |>
select(c(7,2,5,6)) |>
mutate('log2FoldChange'=round(log2FoldChange,2),'padj' = round(padj,2)) |>
arrange(log2FoldChange) |>
head(10)
wtExposed |>
as.data.frame() |>
filter(padj < 0.05 & log2FoldChange < 0) |>
select(c(7,2,5,6)) |>
mutate('log2FoldChange'=round(log2FoldChange,2),'padj' = round(padj,2)) |>
arrange(log2FoldChange) |>
head(10) |>
gt(auto_align = T) |>
gt::gtsave(filename = "./Tables/Top10DGE_DOWNgenesWtExpxp.rtf")
wtExposed |>
as.data.frame() |>
filter(padj < 0.05 & log2FoldChange > 0) |>
select(c(7,2,5,6)) |>
mutate('log2FoldChange'=round(log2FoldChange,2),'padj' = round(padj,2)) |>
arrange(log2FoldChange) |>
head(10)
wtExposed |>
as.data.frame() |>
filter(padj < 0.05 & log2FoldChange > 0) |>
select(c(7,2,5,6)) |>
mutate('log2FoldChange'=round(log2FoldChange,2),'padj' = round(padj,2)) |>
arrange(desc(log2FoldChange)) |>
head(10)
rm(list = ls())
setwd('/Users/gwk/Desktop/Bioinformatics/two-photon-calcium-zebrafish/scripts/oasis_out')
dir()
## Load the required libraries here
library(tidyverse)
library(ggplot2)
library(forcats)
library(gtsummary)
library(ggvenn)
library(RColorBrewer)
library(ggsignif)
library(gridExtra)
library(ggpubr)
dir()
df_spike <- read.csv('"dff_mutExposed4_spikes_oasis.csv"')
df_spike <- read.csv("dff_mutExposed4_spikes_oasis.csv")
head(df_spike)
names(df_spike)
df_spike <- read.csv("dff_mutExposed4_spikes_oasis.csv", row.names = 1)
head(df_spike)
?seq()
frames = seq(0,108, 1)
frames
names(df_spike) <- frames
colnames(df_spike) <- frames
colnames(df_spike) <- frames
leangth(frames)
length(frames)
frames = seq(0,107, 1)
colnames(df_spike) <- frames
head(df_spike)
transpose(df_spike)
?transpose
t(df_spike)
as.data.frame(t(df_spike))
library(data.table)
tanspose(df_spike))
tanspose(df_spike)
transpose(df_spike)
t_df <- transpose(df_spike)
head(t_df)
rownames(t_df) <- colnames(df_spike)
df_spike <- read.csv("dff_mutExposed4_spikes_oasis.csv", row.names = 1)
head(df_spike)
colnames(df_spike) <- frames
t_df <- transpose(df_spike)
rownames(t_df) <- colnames(df_spike)
library(data.table)
frames = seq(0,107, 1)
df_spike <- read.csv("dff_mutExposed4_spikes_oasis.csv", row.names = 1)
head(df_spike)
colnames(df_spike) <- frames
t_df <- transpose(df_spike)
rownames(t_df) <- colnames(df_spike)
colnames(t_df) <- rownames(df_spike)
data.table()
t_df <- data.table(transpose(df_spike))
rownames(t_df) <- colnames(df_spike)
colnames(t_df) <- rownames(df_spike)
head(t_df)
df_spike <- read.csv("dff_mutExposed4_spikes_oasis.csv", row.names = 1, header = T)
head(df_spike)
colnames(df_spike) <- frames
head(df_spike)
t_df <- t(df_spike)
head(t_df)
rownames(t_df) <- colnames(df_spike)
colnames(t_df) <- rownames(df_spike)
head(t_df)
t_df <- transpose(df_spike)
rownames(t_df) <- colnames(df_spike)
colnames(t_df) <- rownames(df_spike)
head(t_df)
head(df_spike)
